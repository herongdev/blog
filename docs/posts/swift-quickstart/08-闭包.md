---
title: Swift 入门（8）：闭包
date: 2025-09-14
categories: Swift
tags: [Swift, iOS, 教程]
---

# Swift 入门（8）：闭包

> 闭包（Closure）是 Swift 的核心特性之一，类似匿名函数。它能捕获上下文变量，非常常用。

## 基本语法

闭包的基本形式：

```swift
{ (参数列表) -> 返回类型 in
    代码块
}
```

例如：

```swift
let add = { (a: Int, b: Int) -> Int in
    return a + b
}
print(add(2, 3))   // 5
```

## 作为函数参数

```swift
func operate(_ a: Int, _ b: Int, op: (Int, Int) -> Int) -> Int {
    return op(a, b)
}

let sum = operate(2, 3, op: { (x, y) in x + y })
print(sum)   // 5
```

## 闭包简写

Swift 提供了简写规则，使闭包更简洁：

1. **省略参数类型和返回值**
2. **省略 return**
3. **使用参数占位符 `$0`, `$1`**

```swift
let nums = [3, 1, 5, 2]
let sorted = nums.sorted(by: { $0 < $1 })
print(sorted)   // [1, 2, 3, 5]
```

## 尾随闭包

当闭包是函数最后一个参数时，可以写在括号外：

```swift
let doubled = nums.map { $0 * 2 }
print(doubled)   // [6, 2, 10, 4]
```

## 捕获变量

闭包会捕获外部变量：

```swift
func makeCounter() -> () -> Int {
    var count = 0
    return {
        count += 1
        return count
    }
}

let counter = makeCounter()
print(counter())   // 1
print(counter())   // 2
```

## 常见应用场景

1. **数组操作（map/filter/reduce）**
2. **回调（网络请求完成后执行）**
3. **延迟执行**

## 小结

- 闭包 = 匿名函数，可以捕获外部变量。
- 语法简洁，支持尾随闭包。
- 常用于集合操作和回调。
