import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.oqSrIbQK.js";const c=JSON.parse('{"title":"CMakeå®æˆ˜ï¼šä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“","description":"æ·±å…¥ç†è§£ CMakeï¼Œä»æœ€ç®€å•çš„ Hello World åˆ°ç”Ÿæˆå…±äº«åº“çš„å®Œæ•´å®æˆ˜æ•™ç¨‹ã€‚","frontmatter":{"title":"CMakeå®æˆ˜ï¼šä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“","date":"2025-01-27T00:00:00.000Z","tags":["CMake","C++","æ„å»ºç³»ç»Ÿ","åŠ¨æ€åº“"],"description":"æ·±å…¥ç†è§£ CMakeï¼Œä»æœ€ç®€å•çš„ Hello World åˆ°ç”Ÿæˆå…±äº«åº“çš„å®Œæ•´å®æˆ˜æ•™ç¨‹ã€‚"},"headers":[],"relativePath":"posts/cppæ•™ç¨‹/åŸºç¡€å…¥é—¨/CMakeå®æˆ˜ï¼šä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“.md","filePath":"posts/cppæ•™ç¨‹/åŸºç¡€å…¥é—¨/CMakeå®æˆ˜ï¼šä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“.md","lastUpdated":1764331727000}'),t={name:"posts/cppæ•™ç¨‹/åŸºç¡€å…¥é—¨/CMakeå®æˆ˜ï¼šä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“.md"};function p(e,s,h,k,d,r){return n(),a("div",null,[...s[0]||(s[0]=[l(`<h1 id="cmake-å®æˆ˜-ä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“" tabindex="-1">CMake å®æˆ˜ï¼šä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“ <a class="header-anchor" href="#cmake-å®æˆ˜-ä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“" aria-label="Permalink to &quot;CMake å®æˆ˜ï¼šä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“&quot;">â€‹</a></h1><blockquote><p>ä»æœ€ç®€å•çš„ CMake èµ·æ­¥ï¼Œä¸€æ­¥æ­¥ç†è§£å¦‚ä½•ç”Ÿæˆå…±äº«åº“ï¼ˆ.so æ–‡ä»¶ï¼‰ï¼Œå¹¶èƒ½è¢«å…¶ä»–ç¨‹åºè°ƒç”¨ã€‚</p></blockquote><h2 id="ğŸ“–-å†…å®¹æ¦‚è§ˆ" tabindex="-1">ğŸ“– å†…å®¹æ¦‚è§ˆ <a class="header-anchor" href="#ğŸ“–-å†…å®¹æ¦‚è§ˆ" aria-label="Permalink to &quot;ğŸ“– å†…å®¹æ¦‚è§ˆ&quot;">â€‹</a></h2><ol><li>CMake æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>æœ€ç®€å•çš„ CMake é¡¹ç›®</li><li>CMake æ ¸å¿ƒæ¦‚å¿µ</li><li>ç”ŸæˆåŠ¨æ€åº“</li><li>å®æˆ˜ï¼šå®Œæ•´çš„ CMake é¡¹ç›®</li><li>è¿›é˜¶ï¼šæ¡ä»¶ç¼–è¯‘å’Œè·¯å¾„ç®¡ç†</li></ol><hr><h2 id="_1-cmake-æ˜¯ä»€ä¹ˆ" tabindex="-1">1. CMake æ˜¯ä»€ä¹ˆï¼Ÿ <a class="header-anchor" href="#_1-cmake-æ˜¯ä»€ä¹ˆ" aria-label="Permalink to &quot;1. CMake æ˜¯ä»€ä¹ˆï¼Ÿ&quot;">â€‹</a></h2><h3 id="_1-1-ä¸ºä»€ä¹ˆéœ€è¦-cmake" tabindex="-1">1.1 ä¸ºä»€ä¹ˆéœ€è¦ CMakeï¼Ÿ <a class="header-anchor" href="#_1-1-ä¸ºä»€ä¹ˆéœ€è¦-cmake" aria-label="Permalink to &quot;1.1 ä¸ºä»€ä¹ˆéœ€è¦ CMakeï¼Ÿ&quot;">â€‹</a></h3><p>åœ¨å­¦ CMake ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ²¡æœ‰å®ƒæ—¶çš„é—®é¢˜ï¼š</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¼ ç»Ÿæ–¹å¼ç¼–è¯‘ï¼ˆæ‰‹å†™æ¯ä¸ªå‘½ä»¤ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add.o</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é—®é¢˜ï¼šå‘½ä»¤å¤æ‚ã€éš¾ä»¥ç»´æŠ¤ã€è·¨å¹³å°å›°éš¾</span></span></code></pre></div><p><strong>CMake çš„ä¼˜åŠ¿</strong>ï¼š</p><ul><li><strong>è·¨å¹³å°</strong>ï¼šWindowsã€Linuxã€macOS éƒ½æ”¯æŒ</li><li><strong>è‡ªåŠ¨åŒ–</strong>ï¼šä¸€æ¬¡é…ç½®ï¼Œåˆ°å¤„ç¼–è¯‘</li><li><strong>ç®¡ç†ä¾èµ–</strong>ï¼šè‡ªåŠ¨å¤„ç†åº“çš„ä¾èµ–å…³ç³»</li><li><strong>ç”Ÿæˆ IDE é¡¹ç›®</strong>ï¼šVSCodeã€Visual Studioã€CLion ç­‰</li></ul><h3 id="_1-2-cmake-çš„ä¸‰ä¸ªé˜¶æ®µ" tabindex="-1">1.2 CMake çš„ä¸‰ä¸ªé˜¶æ®µ <a class="header-anchor" href="#_1-2-cmake-çš„ä¸‰ä¸ªé˜¶æ®µ" aria-label="Permalink to &quot;1.2 CMake çš„ä¸‰ä¸ªé˜¶æ®µ&quot;">â€‹</a></h3><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. é…ç½®    â†’   2. ç”Ÿæˆ    â†’   3. ç¼–è¯‘</span></span>
<span class="line"><span>cmake .         make          ./app</span></span>
<span class="line"><span>                 (ç”ŸæˆMakefile)</span></span></code></pre></div><ol><li><strong>é…ç½®é˜¶æ®µ</strong>ï¼šè¯»å– <code>CMakeLists.txt</code>ï¼Œæ£€æŸ¥ç¯å¢ƒ</li><li><strong>ç”Ÿæˆé˜¶æ®µ</strong>ï¼šç”Ÿæˆ Makefile æˆ–å…¶ä»–æ„å»ºæ–‡ä»¶</li><li><strong>ç¼–è¯‘é˜¶æ®µ</strong>ï¼šæ‰§è¡Œç¼–è¯‘ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“</li></ol><hr><h2 id="_2-æœ€ç®€å•çš„-cmake-é¡¹ç›®" tabindex="-1">2. æœ€ç®€å•çš„ CMake é¡¹ç›® <a class="header-anchor" href="#_2-æœ€ç®€å•çš„-cmake-é¡¹ç›®" aria-label="Permalink to &quot;2. æœ€ç®€å•çš„ CMake é¡¹ç›®&quot;">â€‹</a></h2><h3 id="é¡¹ç›®ç»“æ„" tabindex="-1">é¡¹ç›®ç»“æ„ <a class="header-anchor" href="#é¡¹ç›®ç»“æ„" aria-label="Permalink to &quot;é¡¹ç›®ç»“æ„&quot;">â€‹</a></h3><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>hello/</span></span>
<span class="line"><span>â”œâ”€â”€ CMakeLists.txt</span></span>
<span class="line"><span>â”œâ”€â”€ main.c</span></span>
<span class="line"><span>â””â”€â”€ README.md</span></span></code></pre></div><h3 id="cmakelists-txt" tabindex="-1">CMakeLists.txt <a class="header-anchor" href="#cmakelists-txt" aria-label="Permalink to &quot;CMakeLists.txt&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‘Šè¯‰ CMakeï¼šæˆ‘éœ€è¦è‡³å°‘ 3.16 ç‰ˆæœ¬çš„ CMake</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cmake_minimum_required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3.16)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰é¡¹ç›®ï¼šé¡¹ç›®åå« helloï¼Œä½¿ç”¨ C è¯­è¨€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hello C)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ å¯æ‰§è¡Œæ–‡ä»¶ï¼šåå« hello_app</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä» main.c è¿™ä¸ªæºæ–‡ä»¶ç¼–è¯‘è€Œæ¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_executable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hello_app main.c)</span></span></code></pre></div><h3 id="main-c" tabindex="-1">main.c <a class="header-anchor" href="#main-c" aria-label="Permalink to &quot;main.c&quot;">â€‹</a></h3><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hello, CMake!</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="ç¼–è¯‘è¿è¡Œ" tabindex="-1">ç¼–è¯‘è¿è¡Œ <a class="header-anchor" href="#ç¼–è¯‘è¿è¡Œ" aria-label="Permalink to &quot;ç¼–è¯‘è¿è¡Œ&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºæ„å»ºç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿è¡Œ CMakeï¼ˆé…ç½® + ç”Ÿæˆï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cmake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ..</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç¼–è¯‘</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./hello_app</span></span></code></pre></div><p><strong>è¾“å‡º</strong>ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Hello, CMake!</span></span></code></pre></div><h3 id="è§£é‡Šæ¯ä¸ªå‘½ä»¤" tabindex="-1">è§£é‡Šæ¯ä¸ªå‘½ä»¤ <a class="header-anchor" href="#è§£é‡Šæ¯ä¸ªå‘½ä»¤" aria-label="Permalink to &quot;è§£é‡Šæ¯ä¸ªå‘½ä»¤&quot;">â€‹</a></h3><h4 id="cmake-minimum-required-version-3-16" tabindex="-1"><code>cmake_minimum_required(VERSION 3.16)</code> <a class="header-anchor" href="#cmake-minimum-required-version-3-16" aria-label="Permalink to &quot;\`cmake_minimum_required(VERSION 3.16)\`&quot;">â€‹</a></h4><ul><li><strong>ä½œç”¨</strong>ï¼šæŒ‡å®š CMake çš„æœ€ä½ç‰ˆæœ¬è¦æ±‚</li><li><strong>ä¸ºä»€ä¹ˆ</strong>ï¼šä¸åŒç‰ˆæœ¬çš„ CMake è¯­æ³•å¯èƒ½ä¸åŒ</li><li><strong>ç±»æ¯”</strong>ï¼šå‘Šè¯‰å·¥äºº&quot;ä½ å¾—æœ‰å·¥å…· A æ‰èƒ½å¹²æ´»&quot;</li></ul><h4 id="project-hello-c" tabindex="-1"><code>project(hello C)</code> <a class="header-anchor" href="#project-hello-c" aria-label="Permalink to &quot;\`project(hello C)\`&quot;">â€‹</a></h4><ul><li><strong>ä½œç”¨</strong>ï¼šå®šä¹‰é¡¹ç›®åç§°å’Œä½¿ç”¨çš„è¯­è¨€</li><li><strong>å‚æ•°</strong>ï¼š <ul><li><code>hello</code>ï¼šé¡¹ç›®åç§°</li><li><code>C</code>ï¼šä½¿ç”¨ C è¯­è¨€ï¼ˆä¹Ÿå¯ä»¥æ˜¯ CXX/C++ æˆ–ä¸¤è€…ï¼‰</li></ul></li><li><strong>ç±»æ¯”</strong>ï¼šç»™é¡¹ç›®èµ·ä¸ªåå­—ï¼Œè¯´æ˜ç”¨ä»€ä¹ˆè¯­è¨€</li></ul><h4 id="add-executable-hello-app-main-c" tabindex="-1"><code>add_executable(hello_app main.c)</code> <a class="header-anchor" href="#add-executable-hello-app-main-c" aria-label="Permalink to &quot;\`add_executable(hello_app main.c)\`&quot;">â€‹</a></h4><ul><li><strong>ä½œç”¨</strong>ï¼šæ·»åŠ å¯æ‰§è¡Œæ–‡ä»¶ç›®æ ‡</li><li><strong>å‚æ•°</strong>ï¼š <ul><li><code>hello_app</code>ï¼šç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å</li><li><code>main.c</code>ï¼šæºæ–‡ä»¶åˆ—è¡¨</li></ul></li><li><strong>ç±»æ¯”</strong>ï¼šå‘Šè¯‰ç¼–è¯‘å™¨&quot;æŠŠ main.c ç¼–è¯‘æˆ hello_app ç¨‹åº&quot;</li></ul><hr><h2 id="_3-cmake-æ ¸å¿ƒæ¦‚å¿µ" tabindex="-1">3. CMake æ ¸å¿ƒæ¦‚å¿µ <a class="header-anchor" href="#_3-cmake-æ ¸å¿ƒæ¦‚å¿µ" aria-label="Permalink to &quot;3. CMake æ ¸å¿ƒæ¦‚å¿µ&quot;">â€‹</a></h2><h3 id="_3-1-å˜é‡å’Œè·¯å¾„" tabindex="-1">3.1 å˜é‡å’Œè·¯å¾„ <a class="header-anchor" href="#_3-1-å˜é‡å’Œè·¯å¾„" aria-label="Permalink to &quot;3.1 å˜é‡å’Œè·¯å¾„&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CMAKE_CURRENT_SOURCE_DIRï¼šå½“å‰ CMakeLists.txt æ‰€åœ¨ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¾‹å¦‚ï¼š/home/user/project</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CMAKE_CURRENT_BINARY_DIRï¼šæ„å»ºç›®å½•ï¼ˆé€šå¸¸æ˜¯ build/ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¾‹å¦‚ï¼š/home/user/project/build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CMAKE_SOURCE_DIRï¼šé¡¹ç›®æ ¹ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¾‹å¦‚ï¼š/home/user/project</span></span></code></pre></div><p><strong>å®é™…ä½¿ç”¨</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½®è¾“å‡ºè·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OUTPUT_DIR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/output)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‰“å°è°ƒè¯•ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(STATUS </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Source dir: \${CMAKE_CURRENT_SOURCE_DIR}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(STATUS </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Binary dir: \${CMAKE_CURRENT_BINARY_DIR}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_3-2-æ ‡å‡†è®¾ç½®" tabindex="-1">3.2 æ ‡å‡†è®¾ç½® <a class="header-anchor" href="#_3-2-æ ‡å‡†è®¾ç½®" aria-label="Permalink to &quot;3.2 æ ‡å‡†è®¾ç½®&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½® C è¯­è¨€æ ‡å‡†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD 99)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD_REQUIRED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æˆ–è€…è®¾ç½® C++ æ ‡å‡†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_CXX_STANDARD 17)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_CXX_STANDARD_REQUIRED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_3-3-æ¡ä»¶å’Œæ¶ˆæ¯" tabindex="-1">3.3 æ¡ä»¶å’Œæ¶ˆæ¯ <a class="header-anchor" href="#_3-3-æ¡ä»¶å’Œæ¶ˆæ¯" aria-label="Permalink to &quot;3.3 æ¡ä»¶å’Œæ¶ˆæ¯&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># IF æ¡ä»¶åˆ¤æ–­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VARIABLE)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WARNING </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Variable not set!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(VARIABLE default_value)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">endif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># MESSAGE æ¶ˆæ¯ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(STATUS </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Status message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ™®é€šä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WARNING </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Warning message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è­¦å‘Š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ERROR </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Error message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é”™è¯¯ï¼ˆä¼šåœæ­¢é…ç½®ï¼‰</span></span></code></pre></div><hr><h2 id="_4-ç”ŸæˆåŠ¨æ€åº“" tabindex="-1">4. ç”ŸæˆåŠ¨æ€åº“ <a class="header-anchor" href="#_4-ç”ŸæˆåŠ¨æ€åº“" aria-label="Permalink to &quot;4. ç”ŸæˆåŠ¨æ€åº“&quot;">â€‹</a></h2><h3 id="_4-1-ä»€ä¹ˆæ˜¯åŠ¨æ€åº“" tabindex="-1">4.1 ä»€ä¹ˆæ˜¯åŠ¨æ€åº“ï¼Ÿ <a class="header-anchor" href="#_4-1-ä»€ä¹ˆæ˜¯åŠ¨æ€åº“" aria-label="Permalink to &quot;4.1 ä»€ä¹ˆæ˜¯åŠ¨æ€åº“ï¼Ÿ&quot;">â€‹</a></h3><p><strong>é™æ€åº“ vs åŠ¨æ€åº“</strong>ï¼š</p><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>é™æ€åº“ (.a)</th><th>åŠ¨æ€åº“ (.so)</th></tr></thead><tbody><tr><td>é“¾æ¥æ—¶æœº</td><td>ç¼–è¯‘æ—¶åµŒå…¥åˆ°ç¨‹åº</td><td>è¿è¡Œæ—¶æ‰åŠ è½½</td></tr><tr><td>æ–‡ä»¶ä½“ç§¯</td><td>å¤§</td><td>å°</td></tr><tr><td>æ›´æ–°</td><td>éœ€è¦é‡æ–°ç¼–è¯‘æ•´ä¸ªç¨‹åº</td><td>åªéœ€æ›´æ–°åº“æ–‡ä»¶</td></tr><tr><td>å…±äº«æ€§</td><td>ä¸èƒ½å…±äº«</td><td>å¤šä¸ªç¨‹åºå…±äº«åŒä¸€åº“</td></tr></tbody></table><h3 id="_4-2-åˆ›å»ºç®€å•çš„åŠ¨æ€åº“" tabindex="-1">4.2 åˆ›å»ºç®€å•çš„åŠ¨æ€åº“ <a class="header-anchor" href="#_4-2-åˆ›å»ºç®€å•çš„åŠ¨æ€åº“" aria-label="Permalink to &quot;4.2 åˆ›å»ºç®€å•çš„åŠ¨æ€åº“&quot;">â€‹</a></h3><p><strong>é¡¹ç›®ç»“æ„</strong>ï¼š</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>native_add/</span></span>
<span class="line"><span>â”œâ”€â”€ CMakeLists.txt</span></span>
<span class="line"><span>â”œâ”€â”€ add.h</span></span>
<span class="line"><span>â””â”€â”€ add.c</span></span></code></pre></div><p><strong>CMakeLists.txt</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cmake_minimum_required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3.16)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(native_add C)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½® C æ ‡å‡†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD 99)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD_REQUIRED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿæˆå…±äº«åº“ï¼ˆåŠ¨æ€åº“ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># nativeAdd æ˜¯åº“åï¼Œæœ€ç»ˆç”Ÿæˆ libnativeAdd.so</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SHARED è¡¨ç¤ºç”Ÿæˆå…±äº«åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd SHARED</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    add.c</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="add-h" tabindex="-1">add.h <a class="header-anchor" href="#add-h" aria-label="Permalink to &quot;add.h&quot;">â€‹</a></h3><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#pragma</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> once</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> __cplusplus</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extern</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åŠ æ³•å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‡æ³•å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> subtract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> __cplusplus</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span></code></pre></div><h3 id="add-c" tabindex="-1">add.c <a class="header-anchor" href="#add-c" aria-label="Permalink to &quot;add.c&quot;">â€‹</a></h3><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;add.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> subtract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="ç¼–è¯‘åŠ¨æ€åº“" tabindex="-1">ç¼–è¯‘åŠ¨æ€åº“ <a class="header-anchor" href="#ç¼–è¯‘åŠ¨æ€åº“" aria-label="Permalink to &quot;ç¼–è¯‘åŠ¨æ€åº“&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cmake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span></span></code></pre></div><p><strong>ç”Ÿæˆçš„æ–‡ä»¶</strong>ï¼š</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>build/</span></span>
<span class="line"><span>â””â”€â”€ libnativeAdd.so  â† è¿™å°±æ˜¯ç”Ÿæˆçš„åŠ¨æ€åº“</span></span></code></pre></div><h3 id="_4-3-ä½¿ç”¨åŠ¨æ€åº“" tabindex="-1">4.3 ä½¿ç”¨åŠ¨æ€åº“ <a class="header-anchor" href="#_4-3-ä½¿ç”¨åŠ¨æ€åº“" aria-label="Permalink to &quot;4.3 ä½¿ç”¨åŠ¨æ€åº“&quot;">â€‹</a></h3><p><strong>åˆ›å»ºæµ‹è¯•ç¨‹åº</strong>ï¼š</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>native_add/</span></span>
<span class="line"><span>â”œâ”€â”€ CMakeLists.txt      â† ä¿®æ”¹è¿™ä¸ª</span></span>
<span class="line"><span>â”œâ”€â”€ add.h</span></span>
<span class="line"><span>â”œâ”€â”€ add.c</span></span>
<span class="line"><span>â”œâ”€â”€ main.c              â† æ–°å¢</span></span>
<span class="line"><span>â””â”€â”€ test/</span></span>
<span class="line"><span>    â””â”€â”€ CMakeLists.txt  â† æ–°å¢</span></span></code></pre></div><h3 id="test-main-c" tabindex="-1">test/main.c <a class="header-anchor" href="#test-main-c" aria-label="Permalink to &quot;test/main.c&quot;">â€‹</a></h3><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;stdio.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;add.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;10 + 20 = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, result);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> subtract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;30 - 10 = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, result);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="test-cmakelists-txt" tabindex="-1">test/CMakeLists.txt <a class="header-anchor" href="#test-cmakelists-txt" aria-label="Permalink to &quot;test/CMakeLists.txt&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cmake_minimum_required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3.16)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(native_add_test C)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_executable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(test_app main.c)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é“¾æ¥åŠ¨æ€åº“ nativeAdd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(test_app </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PRIVATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nativeAdd)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ å¤´æ–‡ä»¶æœç´¢è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(test_app </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PRIVATE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ../</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="æ ¹ç›®å½•-cmakelists-txt-ä¿®æ”¹" tabindex="-1">æ ¹ç›®å½• CMakeLists.txtï¼ˆä¿®æ”¹ï¼‰ <a class="header-anchor" href="#æ ¹ç›®å½•-cmakelists-txt-ä¿®æ”¹" aria-label="Permalink to &quot;æ ¹ç›®å½• CMakeLists.txtï¼ˆä¿®æ”¹ï¼‰&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cmake_minimum_required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3.16)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(native_add C)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½®æ ‡å‡†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD 99)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD_REQUIRED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”ŸæˆåŠ¨æ€åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd SHARED</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    add.c</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…¬å¼€å¤´æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ å­ç›®å½•ï¼ˆæµ‹è¯•ç¨‹åºï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_subdirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="ç¼–è¯‘å’Œè¿è¡Œ" tabindex="-1">ç¼–è¯‘å’Œè¿è¡Œ <a class="header-anchor" href="#ç¼–è¯‘å’Œè¿è¡Œ" aria-label="Permalink to &quot;ç¼–è¯‘å’Œè¿è¡Œ&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cmake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./test/test_app</span></span></code></pre></div><p><strong>è¾“å‡º</strong>ï¼š</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>10 + 20 = 30</span></span>
<span class="line"><span>30 - 10 = 20</span></span></code></pre></div><hr><h2 id="_5-å®æˆ˜-å®Œæ•´çš„-cmake-é¡¹ç›®" tabindex="-1">5. å®æˆ˜ï¼šå®Œæ•´çš„ CMake é¡¹ç›® <a class="header-anchor" href="#_5-å®æˆ˜-å®Œæ•´çš„-cmake-é¡¹ç›®" aria-label="Permalink to &quot;5. å®æˆ˜ï¼šå®Œæ•´çš„ CMake é¡¹ç›®&quot;">â€‹</a></h2><h3 id="é¡¹ç›®ç»“æ„-1" tabindex="-1">é¡¹ç›®ç»“æ„ <a class="header-anchor" href="#é¡¹ç›®ç»“æ„-1" aria-label="Permalink to &quot;é¡¹ç›®ç»“æ„&quot;">â€‹</a></h3><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>native_add_complete/</span></span>
<span class="line"><span>â”œâ”€â”€ CMakeLists.txt</span></span>
<span class="line"><span>â”œâ”€â”€ add.h</span></span>
<span class="line"><span>â”œâ”€â”€ add.c</span></span>
<span class="line"><span>â””â”€â”€ example/</span></span>
<span class="line"><span>    â”œâ”€â”€ CMakeLists.txt</span></span>
<span class="line"><span>    â””â”€â”€ main.c</span></span></code></pre></div><h3 id="æ ¹ç›®å½•-cmakelists-txt" tabindex="-1">æ ¹ç›®å½• CMakeLists.txt <a class="header-anchor" href="#æ ¹ç›®å½•-cmakelists-txt" aria-label="Permalink to &quot;æ ¹ç›®å½• CMakeLists.txt&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cmake_minimum_required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3.16)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é¡¹ç›®åå’Œè¯­è¨€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(native_add_complete C)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># C æ ‡å‡†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD 99)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD_REQUIRED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿæˆå…±äº«åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd SHARED</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/add.c</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…¬å¼€å¤´æ–‡ä»¶è·¯å¾„ï¼ˆå…¶ä»–ç¨‹åºå¯ä»¥æ‰¾åˆ° add.hï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ  example å­ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_subdirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(example)</span></span></code></pre></div><h3 id="example-cmakelists-txt" tabindex="-1">example/CMakeLists.txt <a class="header-anchor" href="#example-cmakelists-txt" aria-label="Permalink to &quot;example/CMakeLists.txt&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºç¤ºä¾‹ç¨‹åº</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_executable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(example_main ../main.c)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é“¾æ¥åŠ¨æ€åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(example_main </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PRIVATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nativeAdd)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åŒ…å«å¤´æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(example_main </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PRIVATE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ..</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="example-main-c" tabindex="-1">example/main.c <a class="header-anchor" href="#example-main-c" aria-label="Permalink to &quot;example/main.c&quot;">â€‹</a></h3><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;stdio.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;add.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;=== Native Add Demo ===</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> + </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, a, b, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a, b));</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> - </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, a, b, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">subtract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a, b));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h2 id="_6-è¿›é˜¶-æ¡ä»¶ç¼–è¯‘å’Œè·¯å¾„ç®¡ç†" tabindex="-1">6. è¿›é˜¶ï¼šæ¡ä»¶ç¼–è¯‘å’Œè·¯å¾„ç®¡ç† <a class="header-anchor" href="#_6-è¿›é˜¶-æ¡ä»¶ç¼–è¯‘å’Œè·¯å¾„ç®¡ç†" aria-label="Permalink to &quot;6. è¿›é˜¶ï¼šæ¡ä»¶ç¼–è¯‘å’Œè·¯å¾„ç®¡ç†&quot;">â€‹</a></h2><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ›´å¤æ‚çš„ CMakeLists.txtï¼ˆåŸºäºä½ æä¾›çš„ä¾‹å­ï¼‰ï¼š</p><h3 id="é¡¹ç›®ç»“æ„-2" tabindex="-1">é¡¹ç›®ç»“æ„ <a class="header-anchor" href="#é¡¹ç›®ç»“æ„-2" aria-label="Permalink to &quot;é¡¹ç›®ç»“æ„&quot;">â€‹</a></h3><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>entry/</span></span>
<span class="line"><span>â””â”€â”€ src/</span></span>
<span class="line"><span>    â””â”€â”€ main/</span></span>
<span class="line"><span>        â””â”€â”€ cpp/</span></span>
<span class="line"><span>            â””â”€â”€ 3rd/</span></span>
<span class="line"><span>                â””â”€â”€ native_add/</span></span>
<span class="line"><span>                    â”œâ”€â”€ CMakeLists.txt</span></span>
<span class="line"><span>                    â”œâ”€â”€ add.h</span></span>
<span class="line"><span>                    â””â”€â”€ add.c</span></span></code></pre></div><h3 id="å®Œæ•´çš„-cmakelists-txt-å¸¦è¯¦ç»†æ³¨é‡Š" tabindex="-1">å®Œæ•´çš„ CMakeLists.txtï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰ <a class="header-anchor" href="#å®Œæ•´çš„-cmakelists-txt-å¸¦è¯¦ç»†æ³¨é‡Š" aria-label="Permalink to &quot;å®Œæ•´çš„ CMakeLists.txtï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸­æ–‡æ³¨é‡Šï¼šä»…è´Ÿè´£ç”Ÿæˆ&quot;ç¬¬ä¸‰æ–¹&quot;åŠ¨æ€åº“ libnativeAdd.so</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¹¶æŠŠäº§ç‰©è¾“å‡ºåˆ° entry/libs/&lt;ABI&gt;/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‘Šè¯‰CMakeï¼šæˆ‘éœ€è¦è‡³å°‘3.16ç‰ˆæœ¬çš„CMakeæ‰èƒ½æ­£å¸¸å·¥ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cmake_minimum_required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3.16)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰é¡¹ç›®ï¼šé¡¹ç›®åå« native_add_libï¼Œç”¨çš„æ˜¯Cè¯­è¨€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(native_add_lib C)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½®Cè¯­è¨€æ ‡å‡†ï¼šç”¨C99æ ‡å‡†ï¼ˆ1999å¹´å‘å¸ƒçš„Cè¯­è¨€è§„èŒƒï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD 99)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¦æ±‚å¿…é¡»ä½¿ç”¨è¿™ä¸ªæ ‡å‡†ï¼Œä¸èƒ½é™çº§</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD_REQUIRED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿæˆå…±äº«åº“ï¼ˆåŠ¨æ€åº“ï¼‰ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç›®æ ‡åå« nativeAdd â†’ å®é™…ç”Ÿæˆçš„æ–‡ä»¶å« libnativeAdd.so</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æºç æ–‡ä»¶æ˜¯ add.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd SHARED</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/add.c</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…¬å¼€å¤´æ–‡ä»¶è·¯å¾„ï¼ˆç»™å…¶ä»–è¦ä½¿ç”¨è¿™ä¸ªåº“çš„ç¨‹åºä½¿ç”¨ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿™æ ·åˆ«äººå°±çŸ¥é“å»å“ªé‡Œæ‰¾add.hè¿™æ ·çš„å¤´æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OHOS æ„å»ºæ—¶ä¼šè‡ªåŠ¨å‘Šè¯‰æˆ‘ä»¬æ˜¯ä»€ä¹ˆCPUæ¶æ„ï¼ˆå¦‚ x86_64 / arm64-v8aï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¦‚æœæ²¡æ”¶åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œå°±æ˜¾ç¤ºè­¦å‘Šå¹¶ç”¨é»˜è®¤å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OHOS_ARCH)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WARNING </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OHOS_ARCH not set; default to arm64-v8a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OHOS_ARCH arm64-v8a)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é»˜è®¤ç”¨64ä½ARMæ¶æ„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">endif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½®è¾“å‡ºç›®å½•ï¼šæŠŠç”Ÿæˆçš„ libnativeAdd.so æ”¾åˆ° entry/libs/&lt;CPUæ¶æ„&gt; æ–‡ä»¶å¤¹é‡Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿™æ ·æ‰“åŒ…æ—¶å°±èƒ½è‡ªåŠ¨æ‰¾åˆ°è¿™ä¸ªåº“æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å½“å‰æˆ‘ä»¬åœ¨ï¼šentry/src/main/cpp/3rd/native_add ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OUTPUT_LIB_DIR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/../../../../libs/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${OHOS_ARCH}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MAKE_DIRECTORY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${OUTPUT_LIB_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‘Šè¯‰ç¼–è¯‘ç³»ç»Ÿï¼šæŠŠç”Ÿæˆçš„åº“æ–‡ä»¶æ”¾åˆ°æˆ‘ä»¬æŒ‡å®šçš„ç›®å½•é‡Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set_target_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd PROPERTIES</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    LIBRARY_OUTPUT_DIRECTORY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \${OUTPUT_LIB_DIR}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="é€è¡Œè§£æ" tabindex="-1">é€è¡Œè§£æ <a class="header-anchor" href="#é€è¡Œè§£æ" aria-label="Permalink to &quot;é€è¡Œè§£æ&quot;">â€‹</a></h3><h4 id="åŸºç¡€è®¾ç½®" tabindex="-1">åŸºç¡€è®¾ç½® <a class="header-anchor" href="#åŸºç¡€è®¾ç½®" aria-label="Permalink to &quot;åŸºç¡€è®¾ç½®&quot;">â€‹</a></h4><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cmake_minimum_required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3.16)</span></span></code></pre></div><ul><li>æŒ‡å®šæœ€ä½ CMake ç‰ˆæœ¬ 3.16</li><li>ä½äºè¯¥ç‰ˆæœ¬ä¼šæŠ¥é”™</li></ul><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(native_add_lib C)</span></span></code></pre></div><ul><li>é¡¹ç›®åï¼š<code>native_add_lib</code></li><li>è¯­è¨€ï¼šC</li><li>è‡ªåŠ¨å®šä¹‰å˜é‡ï¼ˆå¦‚ <code>CMAKE_PROJECT_NAME</code>ï¼‰</li></ul><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD 99)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD_REQUIRED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><ul><li>å¯ç”¨ C99 æ ‡å‡†</li><li>å¿…é¡»å¯ç”¨ï¼Œä¸å…è®¸é™çº§</li></ul><h4 id="ç”Ÿæˆåº“" tabindex="-1">ç”Ÿæˆåº“ <a class="header-anchor" href="#ç”Ÿæˆåº“" aria-label="Permalink to &quot;ç”Ÿæˆåº“&quot;">â€‹</a></h4><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd SHARED</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/add.c</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>å‚æ•°</strong>ï¼š</p><ul><li><code>nativeAdd</code>ï¼šç›®æ ‡åï¼Œå®é™…è¾“å‡º <code>libnativeAdd.so</code></li><li><code>SHARED</code>ï¼šå…±äº«åº“</li><li><code>\${CMAKE_CURRENT_SOURCE_DIR}/add.c</code>ï¼šæºæ–‡ä»¶è·¯å¾„</li></ul><p><strong><code>add_library</code> çš„ä¸‰ç§ç±»å‹è¯¦è§£</strong>ï¼š</p><p><strong>â‘  åŠ¨æ€åº“ï¼ˆSHAREDï¼‰</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry SHARED napi_init.cpp)</span></span></code></pre></div><ul><li>ç”Ÿæˆ <code>.so</code> æ–‡ä»¶</li><li>å¤šä¸ªç¨‹åºå¯ä»¥å…±äº«ä½¿ç”¨</li><li>è¿è¡Œæ—¶æ‰åŠ è½½ï¼ŒèŠ‚çœå†…å­˜</li><li>å¯ä»¥æ›´æ–°è€Œä¸é‡æ–°ç¼–è¯‘ä¸»ç¨‹åº</li><li><strong>ç±»æ¯”</strong>ï¼šå…¬å…±å›¾ä¹¦é¦†</li></ul><p><strong>â‘¡ é™æ€åº“ï¼ˆSTATICï¼‰</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry STATIC napi_init.cpp)</span></span></code></pre></div><ul><li>ç”Ÿæˆ <code>.a</code> æ–‡ä»¶</li><li>ä»£ç ç›´æ¥å¤åˆ¶åˆ°æœ€ç»ˆç¨‹åºé‡Œ</li><li>ç¼–è¯‘æ—¶å°±è¢«æ‰“åŒ…è¿›å»</li><li>è¿è¡Œå¿«ï¼Œä½†æ–‡ä»¶ä½“ç§¯å¤§</li><li><strong>ç±»æ¯”</strong>ï¼šç§äººä¹¦æŸœ</li></ul><p><strong>â‘¢ æ¨¡å—åº“ï¼ˆMODULEï¼‰</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry MODULE napi_init.cpp)</span></span></code></pre></div><ul><li>ç”Ÿæˆå¯æ’æ‹”çš„æ¨¡å—</li><li>ä¸è¢«ç›´æ¥é“¾æ¥ï¼Œå¯ä»¥è¢«åŠ¨æ€åŠ è½½</li><li><strong>ç±»æ¯”</strong>ï¼šUSB è®¾å¤‡å³æ’å³ç”¨</li></ul><p><strong>å¯¹æ¯”è¡¨æ ¼</strong>ï¼š</p><table tabindex="0"><thead><tr><th>ç±»å‹</th><th>ç”¨é€”</th><th>ç”Ÿæˆæ–‡ä»¶</th><th>ç±»æ¯”</th></tr></thead><tbody><tr><td>SHARED</td><td>åŠ¨æ€é“¾æ¥åº“</td><td>libXXX.so</td><td>å…¬å…±å›¾ä¹¦é¦†</td></tr><tr><td>STATIC</td><td>é™æ€é“¾æ¥åº“</td><td>libXXX.a</td><td>ç§äººä¹¦æŸœ</td></tr><tr><td>MODULE</td><td>æ’ä»¶æ¨¡å—</td><td>XXX.so</td><td>USB è®¾å¤‡</td></tr><tr><td>INTERFACE</td><td>æ¥å£åº“ï¼ˆå¤´æ–‡ä»¶åº“ï¼‰</td><td>ä¸ç”Ÿæˆæ–‡ä»¶ï¼Œåªæä¾›è·¯å¾„</td><td>æ¥å£æè¿°</td></tr></tbody></table><h4 id="åŒ…å«å¤´æ–‡ä»¶-publicã€privateã€interface-è¯¦è§£" tabindex="-1">åŒ…å«å¤´æ–‡ä»¶ï¼šPUBLICã€PRIVATEã€INTERFACE è¯¦è§£ <a class="header-anchor" href="#åŒ…å«å¤´æ–‡ä»¶-publicã€privateã€interface-è¯¦è§£" aria-label="Permalink to &quot;åŒ…å«å¤´æ–‡ä»¶ï¼šPUBLICã€PRIVATEã€INTERFACE è¯¦è§£&quot;">â€‹</a></h4><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>æƒ³è±¡ä½ åœ¨å»ºæˆ¿å­</strong>ï¼š</p><p><strong>â‘  <code>PUBLIC</code> - &quot;å®Œå…¨å…¬å¼€&quot;</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> include_dir)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> some_lib)</span></span></code></pre></div><ul><li><strong>ç”¨æ³•</strong>ï¼šæˆ‘è‡ªå·±ç”¨ï¼Œæ¥æˆ‘å®¶çš„å®¢äººä¹Ÿèƒ½ç”¨</li><li><strong>ç±»æ¯”</strong>ï¼šæˆ¿å­çš„å¤§é—¨ï¼Œè°éƒ½èƒ½çœ‹åˆ°å’Œé€šè¿‡</li><li><strong>ç‰¹ç‚¹</strong>ï¼šä¾èµ–ä¼šä¼ é€’ç»™æ‰€æœ‰ä½¿ç”¨æˆ‘è¿™ä¸ªåº“çš„äºº</li></ul><p><strong>â‘¡ <code>PRIVATE</code> - &quot;ç§äººä¸“ç”¨&quot;</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PRIVATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> internal_dir)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PRIVATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> internal_lib)</span></span></code></pre></div><ul><li><strong>ç”¨æ³•</strong>ï¼šåªæœ‰æˆ‘è‡ªå·±å†…éƒ¨ä½¿ç”¨</li><li><strong>ç±»æ¯”</strong>ï¼šæˆ¿å­çš„å§å®¤ï¼Œåªæœ‰è‡ªå®¶äººèƒ½ç”¨</li><li><strong>ç‰¹ç‚¹</strong>ï¼šä¾èµ–ä¸ä¼šä¼ é€’ç»™å…¶ä»–äºº</li></ul><p><strong>â‘¢ <code>INTERFACE</code> - &quot;åªç»™å®¢äººç”¨&quot;</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INTERFACE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> header_dir)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INTERFACE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> header_only_lib)</span></span></code></pre></div><ul><li><strong>ç”¨æ³•</strong>ï¼šæˆ‘è‡ªå·±ä¸ç”¨ï¼Œä½†æ¥æˆ‘å®¶çš„å®¢äººéœ€è¦ç”¨</li><li><strong>ç±»æ¯”</strong>ï¼šæˆ¿å­çš„é—¨ç‰Œå·ï¼Œæˆ‘è‡ªå·±ä¸çœ‹ï¼Œä½†å®¢äººéœ€è¦çœ‹</li><li><strong>ç‰¹ç‚¹</strong>ï¼šåªæœ‰å¤´æ–‡ä»¶åº“æˆ–çº¯æ¥å£åº“ç”¨è¿™ä¸ª</li></ul><p><strong>å®é™…ä¾‹å­</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å‡è®¾æˆ‘ä»¬åœ¨å»ºä¸€ä¸ªæ•°å­¦åº“ math_lib</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PUBLICï¼šæ•°å­¦å‡½æ•°æ¥å£ï¼Œæ‰€æœ‰äººéƒ½éœ€è¦çŸ¥é“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(math_lib </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/include  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¤´æ–‡ä»¶ç›®å½•ï¼Œç”¨æˆ·éœ€è¦åŒ…å«</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PRIVATEï¼šå†…éƒ¨å®ç°ç»†èŠ‚ï¼Œç”¨æˆ·ä¸éœ€è¦çŸ¥é“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(math_lib </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PRIVATE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/src/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">internal</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # å†…éƒ¨å¤´æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PUBLICï¼šåŸºç¡€æ•°å­¦åº“ï¼Œç”¨æˆ·ä¹Ÿéœ€è¦é“¾æ¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(math_lib </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    m  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ•°å­¦åº“ libm.soï¼Œç”¨æˆ·ä¹Ÿéœ€è¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PRIVATEï¼šå†…éƒ¨ä¼˜åŒ–åº“ï¼Œç”¨æˆ·ä¸éœ€è¦çŸ¥é“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(math_lib </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PRIVATE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    internal_optimize  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å†…éƒ¨ä¼˜åŒ–åº“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># INTERFACEï¼šåªæœ‰å¤´æ–‡ä»¶çš„æ¨¡æ¿åº“</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(header_only_lib </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INTERFACE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    \${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/headers  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”¨æˆ·éœ€è¦åŒ…å«ï¼Œä½†åº“æœ¬èº«ä¸ç¼–è¯‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>ä¸»ç¨‹åºä½¿ç”¨</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”¨æˆ·åªéœ€è¦è¿™æ ·ï¼š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(app </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PUBLIC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> math_lib)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è‡ªåŠ¨è·å¾—ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - math_lib çš„ PUBLIC å¤´æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - math_lib çš„ PUBLIC é“¾æ¥åº“ï¼ˆå¦‚ libm.soï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - ä½†ä¸ä¼šè·å¾— PRIVATE çš„å†…éƒ¨ç»†èŠ‚</span></span></code></pre></div><p><strong>æ€»ç»“è¡¨æ ¼</strong>ï¼š</p><table tabindex="0"><thead><tr><th>å…³é”®å­—</th><th>è‡ªå·±ç”¨</th><th>åˆ«äººç”¨</th><th>ç±»æ¯”</th></tr></thead><tbody><tr><td>PUBLIC</td><td>âœ…</td><td>âœ…</td><td>å¤§é—¨</td></tr><tr><td>PRIVATE</td><td>âœ…</td><td>âŒ</td><td>å§å®¤</td></tr><tr><td>INTERFACE</td><td>âŒ</td><td>âœ…</td><td>é—¨ç‰Œ</td></tr></tbody></table><p><strong>è®°å¿†æŠ€å·§</strong>ï¼š</p><ul><li><code>PUBLIC</code> = å®Œå…¨å…¬å¼€</li><li><code>PRIVATE</code> = ç§äººä¸“ç”¨</li><li><code>INTERFACE</code> = åªç»™æ¥å£</li></ul><p><strong>å¥½å¤„</strong>ï¼šä¾èµ–å…³ç³»æ¸…æ™°ï¼Œä¸ä¼šæŠŠå†…éƒ¨å®ç°ç»†èŠ‚æ³„éœ²ç»™ç”¨æˆ·</p><h4 id="æ¡ä»¶ç¼–è¯‘" tabindex="-1">æ¡ä»¶ç¼–è¯‘ <a class="header-anchor" href="#æ¡ä»¶ç¼–è¯‘" aria-label="Permalink to &quot;æ¡ä»¶ç¼–è¯‘&quot;">â€‹</a></h4><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OHOS_ARCH)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WARNING </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OHOS_ARCH not set; default to arm64-v8a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OHOS_ARCH arm64-v8a)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">endif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p><strong>è¯´æ˜</strong>ï¼š</p><ul><li><code>if(NOT OHOS_ARCH)</code>ï¼šæœªå®šä¹‰åˆ™æ‰§è¡Œ</li><li><code>message()</code>ï¼šæ‰“å°è­¦å‘Š</li><li><code>set()</code>ï¼šè®¾ç½®é»˜è®¤å€¼</li></ul><p><strong>å˜é‡ä¸åˆ¤æ–­</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å­—ç¬¦ä¸²æ¯”è¾ƒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(VARIABLE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">EQUAL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">endif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ•°å€¼æ¯”è¾ƒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(NUMBER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GREATER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 5)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">endif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¸ƒå°”åˆ¤æ–­</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(VARIABLE)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å·²å®šä¹‰ä¸”éç©º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">endif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VARIABLE)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # æœªå®šä¹‰æˆ–ä¸ºç©º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">endif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h4 id="è·¯å¾„ç®¡ç†" tabindex="-1">è·¯å¾„ç®¡ç† <a class="header-anchor" href="#è·¯å¾„ç®¡ç†" aria-label="Permalink to &quot;è·¯å¾„ç®¡ç†&quot;">â€‹</a></h4><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OUTPUT_LIB_DIR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${CMAKE_CURRENT_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/../../../../libs/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${OHOS_ARCH}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>å½“å‰ç›®å½•ç¤ºä¾‹ï¼š</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>entry/src/main/cpp/3rd/native_add  â† å½“å‰ç›®å½•ï¼ˆCMakeLists.txtåœ¨è¿™é‡Œï¼‰</span></span>
<span class="line"><span>         â†‘        â†‘   â†‘     â†‘        â† åˆ°æ ¹ç›®å½•éœ€è¦å¾€ä¸Šçº§4æ¬¡</span></span></code></pre></div><p>è§£æï¼š</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CMAKE_CURRENT_SOURCE_DIR = entry/src/main/cpp/3rd/native_add</span></span>
<span class="line"><span>                  .. = ../../../                              (å›åˆ° cpp)</span></span>
<span class="line"><span>                  .. = ../../../../../                        (å›åˆ° main)</span></span>
<span class="line"><span>                  .. = ../../../../../../                     (å›åˆ° src)</span></span>
<span class="line"><span>                  .. = ../../../../../../../                  (å›åˆ° entry)</span></span>
<span class="line"><span>libs/\${OHOS_ARCH} = ../../../../libs/arm64-v8a</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æœ€ç»ˆè¾“å‡ºç›®å½•ï¼š</span></span>
<span class="line"><span>entry/libs/arm64-v8a/</span></span></code></pre></div><p><strong>è·¯å¾„åˆ†éš”ä¸å˜é‡</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ \${} è·å–å˜é‡å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MY_PATH </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${CMAKE_SOURCE_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/include)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è·¯å¾„æ‹¼æ¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(OUTPUT_PATH </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;\${CMAKE_BINARY_DIR}/libs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h4 id="åˆ›å»ºç›®å½•" tabindex="-1">åˆ›å»ºç›®å½• <a class="header-anchor" href="#åˆ›å»ºç›®å½•" aria-label="Permalink to &quot;åˆ›å»ºç›®å½•&quot;">â€‹</a></h4><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MAKE_DIRECTORY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${OUTPUT_LIB_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><code>file()</code> ç¤ºä¾‹ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MAKE_DIRECTORY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${OUTPUT_LIB_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¯»å–æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(READ filename.txt variable)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WRITE filename.txt </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¤åˆ¶æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(COPY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${SRC_FILE}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DESTINATION </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${DEST_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h4 id="è®¾ç½®è¾“å‡ºç›®å½•" tabindex="-1">è®¾ç½®è¾“å‡ºç›®å½• <a class="header-anchor" href="#è®¾ç½®è¾“å‡ºç›®å½•" aria-label="Permalink to &quot;è®¾ç½®è¾“å‡ºç›®å½•&quot;">â€‹</a></h4><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set_target_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nativeAdd PROPERTIES</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    LIBRARY_OUTPUT_DIRECTORY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \${OUTPUT_LIB_DIR}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>ä½œç”¨</strong>ï¼šæŒ‡å®šåº“æ–‡ä»¶è¾“å‡ºç›®å½•</p><p>è¾“å‡ºå±æ€§ï¼š</p><table tabindex="0"><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>LIBRARY_OUTPUT_DIRECTORY</code></td><td>åŠ¨æ€åº“è¾“å‡ºç›®å½•</td></tr><tr><td><code>ARCHIVE_OUTPUT_DIRECTORY</code></td><td>é™æ€åº“è¾“å‡ºç›®å½•</td></tr><tr><td><code>RUNTIME_OUTPUT_DIRECTORY</code></td><td>å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºç›®å½•</td></tr></tbody></table><p><strong>ç¤ºä¾‹</strong>ï¼š</p><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½®è¾“å‡ºç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set_target_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(myLib PROPERTIES</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    LIBRARY_OUTPUT_DIRECTORY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \${OUTPUT_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/libs</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    ARCHIVE_OUTPUT_DIRECTORY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> \${OUTPUT_DIR}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/libs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><hr><h2 id="_7-å®æˆ˜æ€»ç»“" tabindex="-1">7. å®æˆ˜æ€»ç»“ <a class="header-anchor" href="#_7-å®æˆ˜æ€»ç»“" aria-label="Permalink to &quot;7. å®æˆ˜æ€»ç»“&quot;">â€‹</a></h2><h3 id="å¤§ç™½è¯æ€»ç»“" tabindex="-1">å¤§ç™½è¯æ€»ç»“ <a class="header-anchor" href="#å¤§ç™½è¯æ€»ç»“" aria-label="Permalink to &quot;å¤§ç™½è¯æ€»ç»“&quot;">â€‹</a></h3><p>è¿™ä¸ª CMakeLists.txt æ‰€åšçš„å·¥ä½œï¼š</p><ol><li>è¦æ±‚ï¼šéœ€è¦ CMake 3.16 ä»¥ä¸Š</li><li>é¡¹ç›®ï¼šå«åš native_add_lib çš„ C è¯­è¨€é¡¹ç›®</li><li>äº§å“ï¼šç”Ÿäº§ libnativeAdd.so</li><li>åŸæ–™ï¼šç”¨ add.c ç”Ÿäº§</li><li>è¯´æ˜ä¹¦ï¼šæŠŠå¤´æ–‡ä»¶è·¯å¾„å…¬å¼€</li><li>é€‚é…ï¼šæ ¹æ® CPUï¼ˆARM/Intelï¼‰é€‰æ–‡ä»¶å¤¹</li><li>å­˜æ”¾ï¼šæ”¾åˆ° entry/libs/ å¯¹åº”æ¶æ„</li></ol><h3 id="å­¦ä¹ è·¯å¾„å»ºè®®" tabindex="-1">å­¦ä¹ è·¯å¾„å»ºè®® <a class="header-anchor" href="#å­¦ä¹ è·¯å¾„å»ºè®®" aria-label="Permalink to &quot;å­¦ä¹ è·¯å¾„å»ºè®®&quot;">â€‹</a></h3><ol><li>å…ˆè·‘é€šç®€å•ç¤ºä¾‹ï¼ˆHello Worldï¼‰</li><li>ç†è§£å˜é‡ã€è·¯å¾„ã€å­é¡¹ç›®</li><li>åŒºåˆ†é™æ€/åŠ¨æ€åº“ä¸è¾“å‡ºç›®å½•</li><li>æŒæ¡å±æ€§ã€æ¡ä»¶ã€ç›®å½•æ“ä½œ</li><li>é€‰ä¸€ä¸ªçœŸå®é¡¹ç›®å®è·µ</li></ol><h3 id="å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥" tabindex="-1">å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥ <a class="header-anchor" href="#å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥" aria-label="Permalink to &quot;å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥&quot;">â€‹</a></h3><div class="language-cmake vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cmake</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åŸºç¡€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cmake_minimum_required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x.y)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LANGUAGES C CXX)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ ç›®æ ‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_executable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SHARED </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_library</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> STATIC </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é“¾æ¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_link_libraries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PRIVATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> library)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target_include_directories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PUBLIC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å­ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add_subdirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(subdir)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½®å˜é‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(VARIABLE </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_C_STANDARD 99)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å‡ºå±æ€§</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set_target_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PROPERTIES</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    LIBRARY_OUTPUT_DIRECTORY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> path</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ–‡ä»¶æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MAKE_DIRECTORY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(STATUS </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;info&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WARNING </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;warning&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><hr><p><strong>æ­å–œä½ æŒæ¡äº† CMake ä»é›¶åˆ°ç”ŸæˆåŠ¨æ€åº“çš„å®Œæ•´æµç¨‹ï¼</strong> ğŸ‰</p>`,172)])])}const g=i(t,[["render",p]]);export{c as __pageData,g as default};
