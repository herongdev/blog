import{_ as i,c as a,o as n,ag as t}from"./chunks/framework.oqSrIbQK.js";const g=JSON.parse('{"title":"åœ¨å“ªé‡Œè°ƒç”¨ useModalManagerStore()ï¼Ÿä¸‰ç§å†™æ³•çš„å®ä¾‹å¯¹æ¯”ä¸å·®å¼‚å…¨é›†","description":"","frontmatter":{"title":"åœ¨å“ªé‡Œè°ƒç”¨ `useModalManagerStore()`ï¼Ÿä¸‰ç§å†™æ³•çš„å®ä¾‹å¯¹æ¯”ä¸å·®å¼‚å…¨é›†","date":"2025-09-26T00:00:00.000Z","tags":["Vue3","Pinia","ç»„åˆå¼å‡½æ•°","SSR","æ€§èƒ½","å¯æµ‹è¯•æ€§"]},"headers":[],"relativePath":"posts/å‰ç«¯/Vue/åœ¨å“ªé‡Œè°ƒç”¨ useModalManagerStore()ï¼Ÿä¸‰ç§å†™æ³•çš„å®ä¾‹å¯¹æ¯”ä¸å·®å¼‚å…¨é›†.md","filePath":"posts/å‰ç«¯/Vue/åœ¨å“ªé‡Œè°ƒç”¨ useModalManagerStore()ï¼Ÿä¸‰ç§å†™æ³•çš„å®ä¾‹å¯¹æ¯”ä¸å·®å¼‚å…¨é›†.md","lastUpdated":1764331727000}'),h={name:"posts/å‰ç«¯/Vue/åœ¨å“ªé‡Œè°ƒç”¨ useModalManagerStore()ï¼Ÿä¸‰ç§å†™æ³•çš„å®ä¾‹å¯¹æ¯”ä¸å·®å¼‚å…¨é›†.md"};function l(k,s,p,e,r,E){return n(),a("div",null,[...s[0]||(s[0]=[t(`<hr><h1 id="ç»“è®ºé€Ÿè§ˆ" tabindex="-1">ç»“è®ºé€Ÿè§ˆ <a class="header-anchor" href="#ç»“è®ºé€Ÿè§ˆ" aria-label="Permalink to &quot;ç»“è®ºé€Ÿè§ˆ&quot;">â€‹</a></h1><ul><li><strong>æœ€ä½³</strong>ï¼šåœ¨<strong>ç»„åˆå¼å†…éƒ¨</strong>ã€<strong>æ–¹æ³•å¤–</strong>åˆ›å»ºï¼ˆæ¨èï¼‰ã€‚</li><li><strong>å¯ç”¨ä½†ä¸ä¼˜</strong>ï¼šåœ¨<strong>æ–¹æ³•å†…éƒ¨</strong>æ¯æ¬¡è°ƒç”¨æ—¶åˆ›å»ºã€‚</li><li><strong>ä¸æ¨è</strong>ï¼šåœ¨<strong>æ¨¡å—é¡¶å±‚</strong>ï¼ˆç»„åˆå¼å¤–ï¼‰åˆ›å»ºã€‚</li></ul><p>ä¸‹é¢ç”¨<strong>æœ€å°å¯è¿è¡Œç‰‡æ®µ</strong>å¯¹æ¯”ä¸‰ç§å†™æ³•åœ¨<strong>å®ä¾‹åŒ–æ¬¡æ•°ã€ä¾èµ–æ³¨å…¥ã€SSR éš”ç¦»ã€HMRã€å¯æµ‹è¯•æ€§ã€ç”Ÿå‘½å‘¨æœŸã€è®¢é˜…å‰¯ä½œç”¨</strong>ä¸Šçš„å·®å¼‚ã€‚</p><hr><h2 id="åŸºç¡€å‡†å¤‡" tabindex="-1">åŸºç¡€å‡†å¤‡ <a class="header-anchor" href="#åŸºç¡€å‡†å¤‡" aria-label="Permalink to &quot;åŸºç¡€å‡†å¤‡&quot;">â€‹</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// stores/modal.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;pinia&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useModalManagerStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;modal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ openCount: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  actions: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.openCount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ ok: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data: { modalId: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;m1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    operationSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {},</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    operationFailed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><hr><h2 id="a-åœ¨ç»„åˆå¼å†…éƒ¨ã€æ–¹æ³•å¤–åˆ›å»º-âœ…-æ¨è" tabindex="-1">A. åœ¨<strong>ç»„åˆå¼å†…éƒ¨ã€æ–¹æ³•å¤–</strong>åˆ›å»ºï¼ˆâœ… æ¨èï¼‰ <a class="header-anchor" href="#a-åœ¨ç»„åˆå¼å†…éƒ¨ã€æ–¹æ³•å¤–åˆ›å»º-âœ…-æ¨è" aria-label="Permalink to &quot;A. åœ¨**ç»„åˆå¼å†…éƒ¨ã€æ–¹æ³•å¤–**åˆ›å»ºï¼ˆâœ… æ¨èï¼‰&quot;">â€‹</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// useCreateAccount.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useModalManagerStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/store&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ref } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useCreateAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¤æ‚é€»è¾‘ï¼šä¾èµ–å½“å‰ app çš„ active piniaï¼›å®ä¾‹åªå–ä¸€æ¬¡ï¼Œå¤ç”¨ä¸” SSR å®‰å…¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> modalStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useModalManagerStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> createAccountLoading</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleCreateAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;internal&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;external&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    createAccountLoading.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> resp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (resp.ok) modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">operationSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;m1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { success: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">finally</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      createAccountLoading.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { handleCreateAccount };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p><strong>è¡¨ç°ä¸ä¼˜åŠ¿</strong></p><ul><li><strong>å®ä¾‹åŒ–æ¬¡æ•°</strong>ï¼šæ¯ä¸ªç»„ä»¶å®ä¾‹ / æ¯æ¬¡è°ƒç”¨ <code>useCreateAccount()</code> ä»…å–ä¸€æ¬¡ storeã€‚</li><li><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šè¯»å–çš„æ˜¯<strong>å½“å‰åº”ç”¨ä¸Šä¸‹æ–‡</strong>çš„ active piniaï¼ˆå¯¹å¾®å‰ç«¯/å¤šå®ä¾‹å‹å¥½ï¼‰ã€‚</li><li><strong>SSR éš”ç¦»</strong>ï¼šæ¯ä¸ªè¯·æ±‚å„è‡ªçš„ piniaï¼Œä¸ä¼šä¸²æ•°æ®ã€‚</li><li><strong>å¯æµ‹è¯•æ€§</strong>ï¼šå•æµ‹é‡Œ <code>setActivePinia(createPinia())</code> å³å¯ï¼›æ˜“ Mockã€‚</li><li><strong>æ€§èƒ½ä¸å¯è¯»æ€§</strong>ï¼šæ— é‡å¤è·å–ï¼Œè¯­ä¹‰æ¸…æ™°ã€‚</li><li><strong>è®¢é˜…å‰¯ä½œç”¨</strong>ï¼šåœ¨ç»„ä»¶/ç»„åˆå¼ç”Ÿå‘½å‘¨æœŸå†…åˆ›å»ºï¼Œéšç»„ä»¶é”€æ¯è€Œé‡Šæ”¾ã€‚</li></ul><hr><h2 id="b-åœ¨æ–¹æ³•å†…éƒ¨åˆ›å»º-ğŸŸ¡-å¯ç”¨ä½†ä¸ä¼˜" tabindex="-1">B. åœ¨<strong>æ–¹æ³•å†…éƒ¨</strong>åˆ›å»ºï¼ˆğŸŸ¡ å¯ç”¨ä½†ä¸ä¼˜ï¼‰ <a class="header-anchor" href="#b-åœ¨æ–¹æ³•å†…éƒ¨åˆ›å»º-ğŸŸ¡-å¯ç”¨ä½†ä¸ä¼˜" aria-label="Permalink to &quot;B. åœ¨**æ–¹æ³•å†…éƒ¨**åˆ›å»ºï¼ˆğŸŸ¡ å¯ç”¨ä½†ä¸ä¼˜ï¼‰&quot;">â€‹</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// useCreateAccount.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useModalManagerStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/store&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ref } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useCreateAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> createAccountLoading</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleCreateAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;internal&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;external&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å¤æ‚é€»è¾‘ï¼šæ¯æ¬¡è°ƒç”¨éƒ½æ‰§è¡Œä¸€æ¬¡ useModalManagerStore()ï¼Œè™½è¿”å›åŒä¸€å®ä¾‹ï¼Œä½†ä¸å¿…è¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> modalStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useModalManagerStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    createAccountLoading.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> resp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (resp.ok) modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">operationSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;m1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { success: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">finally</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      createAccountLoading.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { handleCreateAccount };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p><strong>åˆ©å¼Š</strong></p><ul><li><strong>å®ä¾‹åŒ–æ¬¡æ•°</strong>ï¼šæ–¹æ³•æ¯æ¬¡è¢«è°ƒç”¨éƒ½ä¼šå–ä¸€æ¬¡ï¼ˆPinia ä¼šè¿”å›åŒä¸€å®ä¾‹ï¼Œä½†å¤šä½™çš„å‡½æ•°è°ƒç”¨ä¸å¯è¯»æ€§è´Ÿæ‹…ï¼‰ã€‚</li><li><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šä»èƒ½æ‹¿åˆ°å½“å‰ active piniaã€‚</li><li><strong>SSR</strong>ï¼šå®‰å…¨ï¼Œä½†å¦‚æœæ–¹æ³•åœ¨å¼‚æ­¥å›è°ƒä¸­è¢«é¢‘ç¹è§¦å‘ï¼Œä¼š<strong>å¤šæ¬¡è®¿é—®å®¹å™¨</strong>ã€‚</li><li><strong>å¯æµ‹è¯•æ€§</strong>ï¼šMock ä»å¯ï¼Œä½†éœ€è¦åœ¨<strong>è°ƒç”¨ç‚¹</strong>æ³¨å…¥ç¯å¢ƒã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæå°‘æ•°éœ€è¦<strong>å»¶è¿Ÿå–ç”¨</strong>ï¼ˆåªæœ‰ç”¨æˆ·è§¦å‘æ—¶æ‰è®¿é—® storeï¼‰çš„åœºåˆã€‚</li></ul><hr><h2 id="c-åœ¨æ¨¡å—é¡¶å±‚-ç»„åˆå¼å¤–-åˆ›å»º-âŒ-ä¸æ¨è" tabindex="-1">C. åœ¨<strong>æ¨¡å—é¡¶å±‚</strong>ï¼ˆç»„åˆå¼å¤–ï¼‰åˆ›å»ºï¼ˆâŒ ä¸æ¨èï¼‰ <a class="header-anchor" href="#c-åœ¨æ¨¡å—é¡¶å±‚-ç»„åˆå¼å¤–-åˆ›å»º-âŒ-ä¸æ¨è" aria-label="Permalink to &quot;C. åœ¨**æ¨¡å—é¡¶å±‚**ï¼ˆç»„åˆå¼å¤–ï¼‰åˆ›å»ºï¼ˆâŒ ä¸æ¨èï¼‰&quot;">â€‹</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// useCreateAccount.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useModalManagerStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/store&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¤æ‚é€»è¾‘ï¼šæ¨¡å—åŠ è½½æ—¶å°±å– store â€”â€” ä¼šç»‘å®šâ€œå½“æ—¶çš„ active piniaâ€</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SSR/å¤šåº”ç”¨å®ä¾‹/å¤šè·¯ç”±åº”ç”¨ä¸‹å¯èƒ½å¯¼è‡´è·¨è¯·æ±‚/è·¨å®ä¾‹å…±äº«çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> modalStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useModalManagerStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useCreateAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleCreateAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> resp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (resp.ok) modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">operationSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;m1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { success: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { handleCreateAccount };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p><strong>é£é™©</strong></p><ul><li><strong>ä¾èµ–æ³¨å…¥æ—¶æœºé”™è¯¯</strong>ï¼šåœ¨ app å°šæœª <code>setActivePinia</code> å‰å¯¼å…¥è¯¥æ¨¡å—ï¼Œä¼šæ‹¿åˆ°<strong>ç©ºä¸Šä¸‹æ–‡</strong>æˆ–é”™è¯¯ä¸Šä¸‹æ–‡ã€‚</li><li><strong>SSR æ³„æ¼</strong>ï¼šNode ç«¯<strong>åŒä¸€æ¨¡å—å•ä¾‹</strong>è¢«å¤šä¸ªè¯·æ±‚å¤ç”¨ï¼Œå¯¼è‡´<strong>çŠ¶æ€ä¸²è¯·æ±‚</strong>ã€‚</li><li><strong>HMR/å¤š App</strong>ï¼šçƒ­æ›´æˆ–å¾®å‰ç«¯é‡Œå¯èƒ½æŒ‚åˆ°<strong>ä¸åŒæ ¹å®ä¾‹</strong>ï¼Œä½†è¿™é‡Œå·²ç»‘å®šæ—§å®ä¾‹ã€‚</li><li><strong>è®¢é˜…å‰¯ä½œç”¨</strong>ï¼šè‹¥ store å†…æœ‰è®¢é˜…/watch/å®šæ—¶å™¨ï¼Œé¡¶å±‚åˆ›å»ºä¼š<strong>å¸¸é©»å†…å­˜</strong>ã€‚</li></ul><hr><h2 id="ç»´åº¦å¯¹æ¯”æ¸…å•" tabindex="-1">ç»´åº¦å¯¹æ¯”æ¸…å• <a class="header-anchor" href="#ç»´åº¦å¯¹æ¯”æ¸…å•" aria-label="Permalink to &quot;ç»´åº¦å¯¹æ¯”æ¸…å•&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>ç»´åº¦</th><th>ç»„åˆå¼å†…Â·æ–¹æ³•å¤–ï¼ˆAï¼‰</th><th>æ–¹æ³•å†…ï¼ˆBï¼‰</th><th>æ¨¡å—é¡¶å±‚ï¼ˆCï¼‰</th></tr></thead><tbody><tr><td>å®ä¾‹åŒ–æ¬¡æ•°</td><td>âœ… 1 æ¬¡/ç»„åˆå¼å®ä¾‹</td><td>ğŸŸ¡ æ¯æ¬¡æ–¹æ³•è°ƒç”¨å–ä¸€æ¬¡</td><td>âŒ æ¨¡å—åŠ è½½å³å–</td></tr><tr><td>ä¾èµ–æ³¨å…¥æ—¶æœº</td><td>âœ… æ­£ç¡®ï¼ˆactive pinia å°±ç»ªåï¼‰</td><td>âœ… æ­£ç¡®</td><td>âŒ å¯èƒ½è¿‡æ—©</td></tr><tr><td>SSR è¯·æ±‚éš”ç¦»</td><td>âœ… éš”ç¦»è‰¯å¥½</td><td>âœ… éš”ç¦»è‰¯å¥½</td><td>âŒ æ˜“ä¸²è¯·æ±‚</td></tr><tr><td>HMR/å¤šåº”ç”¨å®ä¾‹</td><td>âœ… å®‰å…¨</td><td>âœ… å®‰å…¨</td><td>âŒ å¯èƒ½æŒ‡å‘æ—§å®ä¾‹</td></tr><tr><td>å¯æµ‹è¯•æ€§/Mock</td><td>âœ… æœ€ä½³</td><td>ğŸŸ¡ å¯</td><td>ğŸŸ¡ éœ€å°å¿ƒç¯å¢ƒ</td></tr><tr><td>æ€§èƒ½/å¯è¯»æ€§</td><td>âœ… æ¸…æ™°</td><td>ğŸŸ¡ å†—ä½™è°ƒç”¨</td><td>ğŸŸ¡ å…¨å±€å‰¯ä½œç”¨</td></tr><tr><td>è®¢é˜…/å‰¯ä½œç”¨é‡Šæ”¾</td><td>âœ… éšç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</td><td>âœ… éšç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</td><td>âŒ å¸¸é©»ã€éš¾é‡Šæ”¾</td></tr></tbody></table><hr><h2 id="å¯è§‚æµ‹å°å®éªŒ-éªŒè¯-æ–¹æ³•å†…å¤šæ¬¡è·å–" tabindex="-1">å¯è§‚æµ‹å°å®éªŒï¼ˆéªŒè¯â€œæ–¹æ³•å†…å¤šæ¬¡è·å–â€ï¼‰ <a class="header-anchor" href="#å¯è§‚æµ‹å°å®éªŒ-éªŒè¯-æ–¹æ³•å†…å¤šæ¬¡è·å–" aria-label="Permalink to &quot;å¯è§‚æµ‹å°å®éªŒï¼ˆéªŒè¯â€œæ–¹æ³•å†…å¤šæ¬¡è·å–â€ï¼‰&quot;">â€‹</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åœ¨ store é‡ŒåŠ ä¸ªæ—¥å¿—ï¼ˆä»…è°ƒè¯•ç”¨ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useModalManagerStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;modal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ openCount: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  actions: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.openCount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ ok: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¤æ‚é€»è¾‘ï¼šPinia çœŸå®åªä¼šè¿”å›ä¸€ä¸ªå®ä¾‹ï¼Œä½†æˆ‘ä»¬ç”¨æ—¥å¿—ç»Ÿè®¡è°ƒç”¨ useModalManagerStore çš„æ¬¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç»„ä»¶é‡Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">handleCreateAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useCreateAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// A ç‰ˆæœ¬ï¼ˆç»„åˆå¼å†…Â·æ–¹æ³•å¤–ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">handleCreateAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">B</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useCreateAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// B ç‰ˆæœ¬ï¼ˆæ–¹æ³•å†…å–ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;internal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;internal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—¥å¿—ï¼šuseModalManagerStore() è°ƒç”¨ 1 æ¬¡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> B</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;internal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> B</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;internal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—¥å¿—ï¼šuseModalManagerStore() è°ƒç”¨ 2 æ¬¡ï¼ˆæ¯æ¬¡æ–¹æ³•æ‰§è¡Œä¸€æ¬¡ï¼‰</span></span></code></pre></div><blockquote><p>è¯´æ˜ï¼š<strong>Pinia ä»ä¼šè¿”å›åŒä¸€ store å®ä¾‹</strong>ï¼Œä½† B å¤šäº†å‡½æ•°è°ƒç”¨ä¸ä¾èµ–è·å–å¼€é”€ï¼›åœ¨é«˜é¢‘äº¤äº’è·¯å¾„ä¸­æ²¡æœ‰å¿…è¦ã€‚</p></blockquote><hr><h2 id="ssr-åœºæ™¯çš„å…¸å‹å‘-ä¸ºä»€ä¹ˆ-c-å±é™©" tabindex="-1">SSR åœºæ™¯çš„å…¸å‹å‘ï¼ˆä¸ºä»€ä¹ˆ C å±é™©ï¼‰ <a class="header-anchor" href="#ssr-åœºæ™¯çš„å…¸å‹å‘-ä¸ºä»€ä¹ˆ-c-å±é™©" aria-label="Permalink to &quot;SSR åœºæ™¯çš„å…¸å‹å‘ï¼ˆä¸ºä»€ä¹ˆ C å±é™©ï¼‰&quot;">â€‹</a></h2><ul><li>æœåŠ¡ç«¯ï¼š<code>import</code> æ—¶å°±æ‰§è¡Œäº† <code>useModalManagerStore()</code>ï¼Œ<strong>ç»‘å®šäº†ç¬¬ä¸€ä¸ªè¯·æ±‚</strong>çš„ piniaã€‚</li><li>ç¬¬äºŒä¸ªè¯·æ±‚æ¥æ—¶ï¼Œæ¨¡å—<strong>ä¸ä¼šé‡æ–°æ‰§è¡Œ</strong>é¡¶å±‚ä»£ç ï¼ˆNode æ¨¡å—ç¼“å­˜ï¼‰ï¼Œå¯¼è‡´<strong>ä¸¤ä¸ªè¯·æ±‚å…±äº«ä¸€ä¸ª store</strong>ï¼Œå‡ºç°æ•°æ®ä¸²è¯ã€‚</li></ul><hr><h2 id="æœ€åç»™å‡ºä½ çš„ç›®æ ‡ç»„åˆå¼çš„æ¨èå†™æ³•" tabindex="-1">æœ€åç»™å‡ºä½ çš„ç›®æ ‡ç»„åˆå¼çš„<strong>æ¨èå†™æ³•</strong> <a class="header-anchor" href="#æœ€åç»™å‡ºä½ çš„ç›®æ ‡ç»„åˆå¼çš„æ¨èå†™æ³•" aria-label="Permalink to &quot;æœ€åç»™å‡ºä½ çš„ç›®æ ‡ç»„åˆå¼çš„**æ¨èå†™æ³•**&quot;">â€‹</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// âœ… useCreateAccount.ts â€”â€” æ¨èæ¨¡å¼ï¼ˆAï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useModalManagerStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/store&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { message } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ant-design-vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ref } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useCreateAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¤æ‚é€»è¾‘ï¼šä¸€æ¬¡è·å–å½“å‰åº”ç”¨ä¸Šä¸‹æ–‡ä¸‹çš„ storeï¼ŒSSR/HMR å®‰å…¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> modalStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useModalManagerStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> createAccountLoading</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleCreateAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;internal&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;external&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> resp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AccountModal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        loading: createAccountLoading.value,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mode: type,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (resp?.ok)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">operationSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(resp.data?.modalId, { success: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      modalStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">operationFailed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e?.modalId, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        message: e?.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;æ“ä½œå¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        code: e?.code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;REQUEST_FAILED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        retryable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e?.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;æ“ä½œå¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { handleCreateAccount };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><hr><h2 id="é€‰æ‹©å»ºè®®-ä¸€å¥è¯ç‰ˆ" tabindex="-1">é€‰æ‹©å»ºè®®ï¼ˆä¸€å¥è¯ç‰ˆï¼‰ <a class="header-anchor" href="#é€‰æ‹©å»ºè®®-ä¸€å¥è¯ç‰ˆ" aria-label="Permalink to &quot;é€‰æ‹©å»ºè®®ï¼ˆä¸€å¥è¯ç‰ˆï¼‰&quot;">â€‹</a></h2><ul><li><strong>æ™®é€š SPA/CSR/SSR</strong>ï¼šé€‰ <strong>Aï¼ˆç»„åˆå¼å†…Â·æ–¹æ³•å¤–ï¼‰</strong>ã€‚</li><li><strong>å¿…é¡»â€œæ‡’è·å–â€ä¾èµ–</strong>ä¸”æ–¹æ³•å¾ˆå°‘è¢«è§¦å‘ï¼š<strong>B</strong>å¯æ¥å—ã€‚</li><li><strong>ä»»ä½•æƒ…å†µä¸‹</strong>ï¼šé¿å… <strong>Cï¼ˆæ¨¡å—é¡¶å±‚ï¼‰</strong>ã€‚</li></ul>`,39)])])}const o=i(h,[["render",l]]);export{g as __pageData,o as default};
